<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>AdminLTE 3 | Fixed Sidebar</title>

		<!-- Google Font: Source Sans Pro -->
		<link rel="stylesheet"
			href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
		<!-- Font Awesome -->
		<link rel="stylesheet" href="../../static/plugins/fontawesome-free/css/all.min.css">
		<!-- overlayScrollbars -->
		<link rel="stylesheet" href="../../static/plugins/overlayScrollbars/css/OverlayScrollbars.min.css">
		<!-- Theme style -->
		<link rel="stylesheet" href="../../static/dist/css/adminlte.min.css">
	</head>
	<body class="hold-transition sidebar-mini layout-fixed">
		<!-- Site wrapper -->
		<div class="wrapper">

			<!-- Content Wrapper. Contains page content -->
			<div class="content-wrapper">
				<!-- Content Header (Page header) -->
				<section class="content-header">
					<div class="container-fluid">
						<div class="row mb-2">
							<div class="col-sm-6">
								<h1>内网穿透服务</h1>
							</div>
							<div class="col-sm-6">
								<ol class="breadcrumb float-sm-right">
									<li class="breadcrumb-item"><a href="#">Home</a></li>
									<li class="breadcrumb-item"><a href="#">Layout</a></li>
									<li class="breadcrumb-item active">Fixed Layout</li>
								</ol>
							</div>
						</div>
					</div><!-- /.container-fluid -->
				</section>

				<!-- Main content -->
				<section class="content">


					<div class="container-fluid">
						<!--        <div class="row">-->
							<div class="row">
								<div class="col-md-12">
									<div id="help1" class="card card-success card-outline">
										<div class="card-header">
											<h3 class="card-title">修改当前用户的登录密码</h3>
										</div>
										<div class="card-body">
											<form id="form1" class="layui-form layui-form-pane" action="/u/doChangePwd" method="POST">
											  <div class="layui-form-item">
											    <label class="layui-form-label">新密码</label>
											    <div class="layui-input-block col-md-4">
											      <input type="password" name="passWord" lay-verify="required" placeholder="请输入新的密码" autocomplete="off" class="layui-input">
											    </div>
											  </div>
											  <div class="layui-form-item">
											    <label class="layui-form-label">确认密码</label>
											    <div class="layui-input-block col-md-4">
											      <input type="password" name="passWord2" lay-verify="required" placeholder="请再次输入新的密码" autocomplete="off" class="layui-input">
											    </div>
											  </div>
											
											<!--  <div class="layui-form-item">
											    <div class="layui-input-block"> -->
											      <button class="btn btn-outline-info" lay-submit="" lay-filter="pwd">修改密码</button>
											    <!-- </div>
											  </div> -->
											
											</form>
											
											
										</div>

									</div>
								</div>
							</div>
						</div>
					</div>
			</div>
		</div>
		</section>
		<!-- /.content -->
		</div>
		<!-- /.content-wrapper -->

		<footer class="main-footer">
			<div class="float-right d-none d-sm-block">
				<b>Version</b> 3.2.0
			</div>
			<strong>Copyright &copy; 2014-2022 <a href="https://adminlte.io">AdminLTE.io</a>.</strong> All rights
			reserved.
		</footer>

		<!-- Control Sidebar -->
		<aside class="control-sidebar control-sidebar-dark">
			<!-- Control sidebar content goes here -->
		</aside>
		<!-- /.control-sidebar -->
		</div>
		<!-- ./wrapper -->

		<!-- jQuery -->
		<script src="../../static/plugins/jquery/jquery.min.js"></script>
		<!-- Bootstrap 4 -->
		<script src="../../static/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
		<!-- overlayScrollbars -->
		<script src="../../static/plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js"></script>
		<!-- AdminLTE App -->
		<script src="../../static/dist/js/adminlte.min.js"></script>

		<script type="text/javascript">
			$(document).ready(function() {

				layui.use(['jquery', 'layer', 'form', 'element'], function() {
					var $ = layui.jquery,
						form = layui.form;
					form.render('select');

				});

				GetMagicStatus();
				GetNetAgentStatus();

			});

			function OpenMagicService() {
				layer.confirm("确定开启穿透服务吗？", {
					btn: ['确定', '取消'] //按钮
				}, function(index, layero) {
					$.post("/u/OpenMagicService", {
						rnd: Math.random()
					}, function(json) {
						if (json.Code == 0) { //成功
							layer.msg("执行成功.");
							GetMagicStatus();
						} else { //失败
							layer.alert(json.Msg, {
								icon: 2
							});

						}
					}, 'json');
				});
			}

			function CloseMagicService() {
				layer.confirm("确定关闭穿透服务吗？", {
					btn: ['确定', '取消'] //按钮
				}, function(index, layero) {
					$.post("/u/CloseMagicService", {
						rnd: Math.random()
					}, function(json) {
						if (json.Code == 0) { //成功
							layer.msg("执行成功.");
							GetMagicStatus();
						} else { //失败
							layer.alert(json.Msg, {
								icon: 2
							});

						}
					}, 'json');
				});
			}

			function GetMagicStatus() {
				$.post("/u/GetMagicStatus", {
					rnd: Math.random()
				}, function(json) {
					var html = "";
					if (json.Code == 0) {
						html += "<font color='green'>" + json.Msg +
							"</font> <br><br><button class='btn btn-outline-info' onclick='CloseMagicService();'>停止服务</button>";
					} else {
						html += "<font color='red'>" + json.Msg +
							"</font> <br><br> <button class='btn btn-outline-info' onclick='OpenMagicService();'>开启服务</button>";
					}

					$("#magicStatus").html(html);

				}, 'json');
			}

			function GetNetAgentStatus() {
				$.post("/u/GetNetAgentStatus", {
					rnd: Math.random()
				}, function(json) {
					var html = "";
					if (json.Code == 0) {
						html += "<font color='green'>" + json.Msg + "</font>";
					} else {
						html += "<font color='red'>" + json.Msg + "</font>";
					}

					$("#netAgentStatus").html(html);

				}, 'json');
			}

			function ClearNetAgentStatus() {
				$.post("/u/ClearNetAgentStatus", {
					rnd: Math.random()
				}, function(json) {
					var html = "";
					if (json.Code == 0) {
						$("#netAgentStatus").html("<font color='red'>未检测到Agent连接</font>");
					} else {
						layer.alert(json.Msg, {
							icon: 2
						});
					}


				}, 'json');
			}

			function StartAgentJob() {
				var formData = $("#form2").serialize();
				$.post("/u/StartAgentJob", formData, function(json) {

					if (json.Code == 0) {
						//$("#agentForwardInfo").html("");
						loadFrameContent("/u/NetAgent");
					} else {
						layer.alert(json.Msg, {
							icon: 2
						});
					}

				}, 'json');
			}

			function StopAgentJob() {
				$.post("/u/StopAgentJob", {
					rnd: Math.random()
				}, function(json) {
					if (json.Code == 0) {
						loadFrameContent("/u/NetAgent");
					} else {
						layer.alert(json.Msg, {
							icon: 2
						});
					}

				}, 'json');
			}
		</script>


	</body>
</html>
